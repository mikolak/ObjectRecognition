<Task>
	<!-- reference task information -->
	<Reference>
		<Author>
			<name>Mikołaj Kojdecki</name>
			<link></link>
		</Author>
	
		<Description>
			<brief>Processing path for detecting "go" stones</brief>
			<full>Processing path for detecting "go" stones. For the time consists of:
				1. Image acquisition,
				2. Median blurring,
				3. Contrast manipulation,
				4. Edge detection using spatial convolution approximation of an laplassian.
				5. Visualization for original and processed images.
			</full>
		</Description>
	</Reference>

	<!-- task definition -->
	<Subtasks>
		<Subtask name="Acquisition">
			<Executor name="SourceExec" period="5"> <!-- było: 0.05  -->
				<Component name="Source" type="CvBasic:Sequence" priority="1" bump="0">
					<param name="sequence.directory">%[TASK_LOCATION]%/../obrazy</param>
                                        <param name="sequence.pattern">.*</param>
                                        <param name="mode.loop">1</param>
                                        <param name="mode.iterate">1</param>	
				</Component>
				<!-- <Component name="Source" type="CameraUniCap:CameraUniCap" priority="1" bump="0">
					<param name="device">0</param>
				</Component> -->
			</Executor>
		</Subtask>
		<Subtask name="Processing">
			<Executor name="MedianExec" period="0.1">
				<Component name="Newest1" type="ObjectRecognition:NewestImage" priority="1" bump="0">
				</Component>
				<Component name="Median" type="ObjectRecognition:RankFiltering" priority="2" bump="0">
					<param name="rank">4</param>
                		</Component>
			</Executor>
			<Executor name="ProcExec" period="0.1">
				<!-- @TODO
				<Component name="Inversion" type="ObjectRecognition:ColorInversion" priority="1" bump="0">
				</Component> 
				-->
				<Component name="Newest2" type="ObjectRecognition:NewestImage" priority="1" bump="0">
                		</Component>
				<Component name="Contrast" type="ObjectRecognition:ContrastManipulation" priority="1" bump="0">
					<param name="contrast_gain">1.1</param>
				</Component>
				<!-- 
				<Component name="Brightness" type="ObjectRecognition:BrightnessManipulation" priority="1" bump="0">
					<param name="gain">30</param>
				</Component> -->
				<Component name="Processor" type="CvBasic:CvCanny" priority="2" bump="0">
				</Component>
				<!-- <Component name="Processor" type="ObjectRecognition:ConvolutionFilter" priority="2" bump="0">
				 returns gray image 
				</Component> -->
			</Executor>
			<Executor name="PostProcExec" period="0.1">
				<Component name="Newest3" type="ObjectRecognition:NewestImage" priority="1" bump="0">
                		</Component>
				<Component name="Binarization" type="ObjectRecognition:Thresholding" priority="1" bump="0">
					<param name="threshold">100</param>
				</Component>
				<Component name="GSBlur" type="ObjectRecognition:RankFiltering" priority="2" bump="0">
					<param name="rank">4</param>
				</Component>
			</Executor>
			<Executor name="PostProcExec2" period="0.1">
				<Component name="Newest4" type="ObjectRecognition:NewestImage" priority="1" bump="0">
                		</Component>
				<Component name="Dilation" type="ObjectRecognition:RankFiltering" priority="2" bump="0">
					<param name="rank">8</param>
				</Component>
				<Component name="Erosion" type="ObjectRecognition:RankFiltering" priority="3" bump="0">
					<param name="rank">0</param>
				</Component>
				<!-- @TODO
				<Component name="Segmentation" type="ObjectRecognition:Segmentation" priority="4" bump="0">
					<param name="channel>2</param>
					<param name="start_val>30</param>
					<param name="inc_val">5</param>
				</Component> -->
			</Executor> 
		</Subtask>	
		<Subtask name="Visualisation">
			<Executor name="VisualExec" period="0.1"> <!-- było 0.01 -->
				<Component name="Window" type="CvBasic:CvWindow" priority="1" bump="0">
					<param name="count">3</param>
					<param name="title">Obraz,Kontrast,Krawedzie</param>
				</Component>
			</Executor>
		</Subtask>
	</Subtasks>
	
	<!-- connections between events and handelrs -->
	<Events>
	</Events>
	
	<!-- pipes connecting datastreams -->
	<DataStreams>
		<Source name="Source.out_img">
			<sink>Window.in_img0</sink>
			<sink>Newest1.in_img</sink>
		</Source>
		<Source name="Newest1.out_img">
			<sink>Median.in_img</sink>
		</Source>
		<Source name="Median.out_img">
			<sink>Newest2.in_img</sink>
		</Source>
		<Source name="Newest2.out_img">
           		<sink>Contrast.in_img</sink>
		</Source>
		<Source name="Contrast.out_img">
			<sink>Processor.in_img</sink>
			<sink>Window.in_img1</sink>
		</Source>
		<!-- 
		<Source name="Brightness.out_img">
			<sink>Processor.in_img</sink>
			<sink>Window.in_img1</sink>
		</Source> -->
		<Source name="Processor.out_img">
			<sink>Newest3.in_img</sink>
		</Source>
		<Source name="Newest3.out_img">
                        <sink>Binarization.in_img</sink>
                </Source>
		<Source name="Binarization.out_img">
			<sink>GSBlur.in_img</sink>
		</Source>
		<Source name="GSBlur.out_img">
			<sink>Newest4.in_img</sink>
		</Source>
		<Source name="Newest4.out_img">
                        <sink>Dilation.in_img</sink>
                </Source>
		<Source name="Dilation.out_img">
			<sink>Erosion.in_img</sink>
		</Source>
		<Source name="Erosion.out_img">
			<sink>Window.in_img2</sink>
		</Source>
	</DataStreams>
</Task>

